<!DOCTYPE html>
<html>
<head>
    <title>Signup</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        body{
            font-family: Arial;
            background: linear-gradient(135deg,#667eea,#764ba2);
            height:100vh;
            display:flex;
            justify-content:center;
            align-items:center;
            color:white;
            margin: 0;
        }
        .box{
            background:rgba(0,0,0,0.4);
            padding:40px;
            border-radius:12px;
            width:350px;
            text-align: center;
        }
        input, button{
            width:100%;
            padding:12px;
            margin:10px 0;
            border:none;
            border-radius:8px;
            box-sizing: border-box;
        }
        button{
            background:#ff9800;
            color:white;
            font-weight:bold;
            cursor: pointer;
        }
        button:hover { background: #e68a00; }
    </style>
</head>
<body>

<div class="box">
    <h2>Create Account</h2>
    <form id="signupForm">
        {% csrf_token %}
        <input type="text" name="username" placeholder="Username" required>
        <input type="email" name="email" placeholder="Email" required>
        <input type="password" name="password" placeholder="Password" required>
        <button type="submit" id="submitBtn">Signup</button>
    </form>

    <p><a href="/login/" style="color: white; text-decoration: none; font-size: 14px;">Already have an account?</a></p>
</div>

<script>
    const form = document.getElementById('signupForm');
    
    form.addEventListener('submit', function(e) {
        e.preventDefault(); // পেজ রিলোড বন্ধ করবে

        const formData = new FormData(form);

        fetch('', {  // বর্তমান URL-এ ডাটা পাঠাবে
            method: 'POST',
            body: formData,
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.status === 'success') {
                // ১. সফলতার অ্যানিমেশন দেখাবে
                Swal.fire({
                    title: 'Account Created!',
                    text: 'Redirecting to login page...',
                    icon: 'success',
                    timer: 2000,
                    showConfirmButton: false
                }).then(() => {
                    // ২. ২ সেকেন্ড পর অটো লগইন পেজে নিয়ে যাবে
                    window.location.href = "/login/"; 
                });
            } else {
                Swal.fire('Error', data.message, 'error');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            Swal.fire('Error', 'Something went wrong!', 'error');
        });
    });
</script>

</body>
</html>